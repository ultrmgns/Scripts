# Prompt the user for the source and destination folders
$sourceFolder = Read-Host -Prompt "Please enter the path of the source folder (Folder A)"
$destinationFolder = Read-Host -Prompt "Please enter the path of the destination folder (Folder B)"

# Get list of files in both folders
$fileListA = Get-ChildItem -Path $sourceFolder -Recurse | Select-Object FullName, LastWriteTime
$fileListB = Get-ChildItem -Path $destinationFolder -Recurse | Select-Object FullName, LastWriteTime

# Compare the two lists and copy newer files from SourceFolder to DestinationFolder
Compare-Object -ReferenceObject $fileListA -DifferenceObject $fileListB -PassThru | Where-Object { $_.SideIndicator -eq "=>" } | ForEach-Object {
  # Check if the destination file exists before copying
  if (Test-Path -Path $_.FullName) {
      # Copy the file only if it has been modified more recently
      if ($_.LastWriteTime -gt (Get-Item -Path $($_.FullName) -ErrorAction SilentlyContinue).LastWriteTime) {
          Copy-Item -Path $($_.InputObject).FullName -Destination $($_.FullName)
      }
  } else {
      # Create the destination directory if it doesn't exist
      New-Item -ItemType Directory -Path $(Split-Path -Path $($_.FullName) -Parent) -Force | Out-Null

      # Copy the file to the destination directory
      Copy-Item -Path $($_.InputObject).FullName -Destination $($_.FullName)
  }
}
